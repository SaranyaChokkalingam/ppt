import csv
import chromadb

def main():
    csv_file = "embeddings_clean.csv"
    client = chromadb.Client()
    collection = client.get_or_create_collection("my_java_embeddings")

    with open(csv_file, 'r', encoding='utf-8') as f:
        reader = csv.reader(f)
        header = next(reader)  # skip header

        for i, row in enumerate(reader):
            text = row[0]
            # Convert all remaining values to float list
            embedding = [float(val) for val in row[1:]]

            collection.add(
                documents=[text],
                embeddings=[embedding],
                ids=[f"id_{i}"]
            )

    print(f"âœ… Loaded {i+1} records into Chroma collection 'my_java_embeddings'.")

if __name__ == "__main__":
    main()
